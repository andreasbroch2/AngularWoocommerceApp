<ion-header>
  <ion-toolbar color="light">
    <ion-title color="primary">Måltidskasse</ion-title>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/"></ion-back-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>
<ion-content padding>
  <app-count-down></app-count-down>
  <div class="spin" *ngIf="!details">
    <ion-spinner color="light" name="crescent"></ion-spinner>
  </div>
  <div class="loadbar" *ngIf="load">
    <ion-spinner color="light" name="crescent"></ion-spinner>
    <ion-text color="light">  {{ load }}</ion-text> 
  </div>
  <div *ngIf="details" color="light">
        <div class="abonnement">
          <div>
            <ion-icon name="cube"></ion-icon>
          </div>
          <div>
            <p id="id">#{{ details.id }}</p>
            <p id="overskrift">Din Måltidskasse</p>
          </div>
          <div>
            <div *ngIf="details.status==='active'" class="statusboksaktiv">Aktiv</div>
            <div *ngIf="details.status==='on-hold'" class="statusbokspause">På pause</div>
            <div *ngIf="details.status==='cancelled'" class="statusboksafmeldt">Afmeldt</div>
          </div> 
        </div>
        <div button (click)="showContent()" class="collapsible">
          <div class="grid154045">
              <ion-icon size="small" src="/assets/icon/shipping.svg"></ion-icon>
              <ion-text class="noticelabel">Næste levering</ion-text>
              <ion-text class="noticevalue">  {{ addDays(details.next_payment_date, 4) | date:'EEEE \'d\' d MMMM'}} </ion-text>
              <ion-icon *ngIf="hidden" name="chevron-down"></ion-icon>
              <ion-icon *ngIf="!hidden" name="chevron-up"></ion-icon>
          </div>
          <div id="leveringscontent">
            <hr>
            <p class="contentheading">Leveres </p>
            <p *ngIf="details.billing_interval==='1'">Hver Uge <ion-icon size="small" name="pencil"></ion-icon></p>
            <p *ngIf="details.billing_interval==='2'">Hver 2. Uge <ion-icon size="small" name="pencil"></ion-icon></p>
            <p *ngIf="details.billing_interval==='4'">Hver 4. Uge <ion-icon size="small" name="pencil"></ion-icon></p>
            <p class="contentheading">Leveringsadresse</p>
              <div class="adresselabel">
                Navn
              </div>
              <div class="adressevalue">
                {{details.shipping.first_name}} {{details.shipping.last_name}}
              </div>
              <hr>
              <div class="adresselabel">
                Adresse
              </div>
              <div class="adressevalue">
                {{details.shipping.address_1}} {{details.shipping.address_2}}
              </div>
              <hr>
              <div class="adresselabel">
                Postnr. og by
              </div>
              <div class="adressevalue">
                {{details.shipping.postcode}} {{details.shipping.city}}
              </div>
          </div>
        </div>
        <div button (click)="showContentKasse()" class="collapsible">
          <div class="grid154045">
              <ion-icon size="small" name="cube"></ion-icon>
              <ion-text class="noticelabel">Måltidskassen</ion-text>
              <ion-text class="noticevalue">  {{details.line_items.length}} varer </ion-text>
              <ion-icon *ngIf="hiddenkasse" name="chevron-down"></ion-icon>
              <ion-icon *ngIf="!hiddenkasse" name="chevron-up"></ion-icon>
          </div>
          <div id="kassecontent">
            <ion-button expand="block" (click)="presentModal()">Tilføj</ion-button>
            <ion-grid class="kort" >
              <ion-row *ngFor="let item of details.line_items">
                <ion-col size="8">
                  {{ item.name }}
                </ion-col>
                <ion-col size="1">
                  {{ item.quantity }}
                </ion-col>
                <ion-col size="2">
                  <ion-text class="total">  {{ addNumbers(item.total, item.total_tax) | number}},- </ion-text>
                </ion-col>
                <ion-col size="1">
                  <ion-button color="tertiary" size="small" (click)="removeprod(item.id)">X</ion-button>
                </ion-col>
              </ion-row>
            </ion-grid>
          </div>
        </div>
        <div button (click)="showContentBetaling()" class="collapsible">
          <div class="grid154045">
              <ion-icon size="small" name="card"></ion-icon>
              <ion-text class="noticelabel">Betaling</ion-text>
              <ion-text class="noticevalue">  {{details.total}} </ion-text>
              <ion-icon *ngIf="hiddenbetaling" name="chevron-down"></ion-icon>
              <ion-icon *ngIf="!hiddenbetaling" name="chevron-up"></ion-icon>
          </div>
          <div id="betalingcontent">
            <hr>
            <p class="contentheading">Leveres </p>
            <p *ngIf="details.billing_interval==='1'">Hver Uge <ion-icon size="small" name="pencil"></ion-icon></p>
            <p *ngIf="details.billing_interval==='2'">Hver 2. Uge <ion-icon size="small" name="pencil"></ion-icon></p>
            <p *ngIf="details.billing_interval==='4'">Hver 4. Uge <ion-icon size="small" name="pencil"></ion-icon></p>
            <p class="contentheading">Leveringsadresse</p>
              <div class="adresselabel">
                Navn
              </div>
              <div class="adressevalue">
                {{details.shipping.first_name}} {{details.shipping.last_name}}
              </div>
              <hr>
              <div class="adresselabel">
                Adresse
              </div>
              <div class="adressevalue">
                {{details.shipping.address_1}} {{details.shipping.address_2}}
              </div>
              <hr>
              <div class="adresselabel">
                Postnr. og by
              </div>
              <div class="adressevalue">
                {{details.shipping.postcode}} {{details.shipping.city}}
              </div>
          </div>
        </div>
        <h3>Handlinger</h3>
        <ion-item *ngIf="details.status==='active'" button (click)="pause()">
          <ion-icon slot="start" name="pause-circle"></ion-icon>
            <ion-label>
              Sæt på pause
            </ion-label>
        </ion-item>
        <ion-item *ngIf="details.status==='on-hold'" button (click)="pause()">
          <ion-icon slot="start" name="play-circle"></ion-icon>
            <ion-label>
              Aktivér
            </ion-label>
        </ion-item>
        <ion-item *ngIf="details.status==='active'" button (click)="skip()">
          <ion-icon slot="start" name="play-forward-circle"></ion-icon>
            <ion-label>
              Udskyd levering
            </ion-label>
        </ion-item>
        <ion-item *ngIf="details.status!='cancelled'" button (click)="afmeld()">
          <ion-icon slot="start" name="trash"></ion-icon>
            <ion-label>
              Afmeld måltidskasse
            </ion-label>
        </ion-item>
        <ion-item *ngIf="details.status==='cancelled'" button (click)="afmeld()">
          <ion-icon slot="start" name="play-circle"></ion-icon>
            <ion-label>
              Genaktivér
            </ion-label>
        </ion-item>
        <ion-button (click)="frek()">Ændre frekvens</ion-button>
        <ion-icon src="/assets/icon/shipping.svg"></ion-icon>
        <br>
        <ion-text>  {{ addDays(details.next_payment_date, 4) | date:'EEEE \'d\' d MMMM'}} </ion-text>
        <br>
        <ion-button  (click)="skip()">Spring Over</ion-button>
        <ion-icon name="restaurant"></ion-icon>
        <br>
        <ion-text>{{details.line_items.length}}</ion-text>
        <ion-icon name="card"></ion-icon>
        <br>
        <ion-text>{{ details.next_payment_date | date:'EEEE \'d\' d MMMM'}} </ion-text>
</div>

    {{ details.shipping_lines[0].method_title}}
    <ion-text class="pris">  {{ addNumbers(details.shipping_total, details.shipping_tax) | number}},- </ion-text>
</ion-content>